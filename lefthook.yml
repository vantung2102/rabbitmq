commit-msg:
  commands:
    lint-commit-msg:
      run: yarn commitlint --edit $1

pre-commit:
  parallel: true
  commands:
    zeitwerk:
      run: bundle exec rails zeitwerk:check
    rubocop:
      tags: backend style
      # foo.rb, foo.rake or Foofile
      glob: '{*.{rb,rake,slim},[A-Z]*file}'
      run: bundle exec rubocop --force-exclusion {staged_files}
    secrets-detection:
      tags: secrets
      files: git diff --name-only --diff-filter=d --staged
      run: 'if command -v gitleaks > /dev/null 2>&1; then gitleaks protect --no-banner --staged --redact --verbose; else echo "WARNING: gitleaks is not installed. Please install it. See https://github.com/zricethezav/gitleaks#installing."; fi'
    eslint:
      tags: frontend style
      glob: '*.{js}'
      run: yarn lint {staged_files}
    slim-lint:
      tags: frontend style
      glob: '*.{slim}'
      run: bundle exec slim-lint {staged_files}
# TODO: If you want to check rspec or bundle-audit before pushing, add them here:
# pre-push:
#   1_rspec:
#     skip_empty: false
#     run: bundle exec rspec
#   2_bundle-audit:
#     skip_empty: false
#     run: bundle exec bundle-audit check
